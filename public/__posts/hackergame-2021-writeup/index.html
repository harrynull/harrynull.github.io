<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>Hackergame 2021 Writeup | Harry Yu | Blog</title>
<meta name="keywords" content="CTF, è§£è°œ">
<meta name="description" content="Hackergame (ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦ç¬¬å…«å±Šä¿¡æ¯å®‰å…¨å¤§èµ›) ä¼ é€é—¨ï¼šhackergame
è¿™æ¬¡æ‘¸äº†ä¸ª rank 31 (å·ä¸åŠ¨äº†)ã€‚è¿™é‡ŒæŒ‘äº†å‡ é“æ„Ÿè§‰æ¯”è¾ƒæœ‰æ„æ€çš„é¢˜ç›®å†™ write-upã€‚

">
<meta name="author" content="">
<link rel="canonical" href="http://localhost:1313/__posts/hackergame-2021-writeup/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.4599eadb9eb2ad3d0a8d6827b41a8fda8f2f4af226b63466c09c5fddbc8706b7.css" integrity="sha256-RZnq256yrT0KjWgntBqP2o8vSvImtjRmwJxf3byHBrc=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/__posts/hackergame-2021-writeup/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Harry Yu | Blog (Alt + H)">Harry Yu | Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Hackergame 2021 Writeup
    </h1>
    <div class="post-meta"><span title='2021-10-30 11:01:09 +0000 UTC'>October 30, 2021</span>

</div>
  </header> 
  <div class="post-content"><p>Hackergame (ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦ç¬¬å…«å±Šä¿¡æ¯å®‰å…¨å¤§èµ›) ä¼ é€é—¨ï¼š<a href="https://hack.lug.ustc.edu.cn/">hackergame</a></p>
<p>è¿™æ¬¡æ‘¸äº†ä¸ª rank 31 (å·ä¸åŠ¨äº†)ã€‚è¿™é‡ŒæŒ‘äº†å‡ é“æ„Ÿè§‰æ¯”è¾ƒæœ‰æ„æ€çš„é¢˜ç›®å†™ write-upã€‚</p>
<p><img loading="lazy" src="https://i.loli.net/2021/10/30/jG3nUAL1Bt59g7K.jpg" alt="rk.jpg"  />
</p>
<h2 id="å–ç“œ">å–ç“œ<a hidden class="anchor" aria-hidden="true" href="#å–ç“œ">#</a></h2>
<blockquote>
<p>ä½ ï¼šä½ ç§ç§ç°åœ¨å“ªæœ‰ç“œå•Šï¼Ÿè¿™éƒ½æ˜¯å¤§æ£šçš„ç“œï¼Œåªæœ‰ 6 æ–¤ä¸€ä¸ªå’Œ 9 æ–¤ä¸€ä¸ªçš„ï¼Œä½ å«Œè´µæˆ‘è¿˜å«Œè´µå‘¢ã€‚</p>
<p>HQï¼šç»™æˆ‘æ¥ 20 æ–¤çš„ç“œã€‚</p>
<p>ä½ ï¼šè¡Œï¼</p>
<p>HQï¼šè¡Œï¼Ÿè¿™ç“œèƒ½ç§°å‡º 20 æ–¤å—ï¼Ÿ</p>
<p>ä½ ï¼šæˆ‘å¼€æ°´æœæ‘Šçš„ï¼Œè¿˜ä¸ä¼šç§°é‡ï¼Ÿ</p>
<p>HQï¼šæˆ‘é—®ä½ è¿™ç“œèƒ½ç§°å‡º 20 æ–¤å—ï¼Ÿ</p>
<p>ä½ ï¼šä½ æ˜¯æ•…æ„æ‰¾èŒ¬ï¼Œæ˜¯ä¸æ˜¯ï¼Ÿä½ è¦ä¸è¦å§ï¼</p>
<p>HQï¼šä½ è¿™ç“œè¦æ˜¯åˆšå¥½ 20 æ–¤å—æˆ‘è‚¯å®šè¦å•Šã€‚é‚£å®ƒè¦æ˜¯æ²¡æœ‰æ€ä¹ˆåŠå•Šï¼Ÿ</p>
<p>ä½ ï¼šè¦æ˜¯ä¸æ˜¯ 20 æ–¤ï¼Œæˆ‘è‡ªå·±åƒäº†å®ƒï¼Œæ»¡æ„äº†å§ï¼Ÿ</p>
</blockquote>
<p><img loading="lazy" src="https://i.loli.net/2021/10/30/fDsuhjzM9d2Bt8x.jpg" alt="melon.jpg"  />
</p>
<p>ä¸€å¼€å§‹è€ƒè™‘ç”¨å°æ•°ï¼Œä½†æ˜¯å‘ç°å°±ç®—æ˜¯ç›´æ¥æ”¹ post payload ä¹Ÿä¸ä¼šæ¥å—å°æ•°è¾“å…¥ï¼ˆå¥½åƒä¼šè¢«ç›´æ¥ truncate æ‰ï¼‰ã€‚é¡ºä¾¿è¯•äº†ä¸€ä¸‹è´Ÿæ•°ä¹Ÿä¸å¯ä»¥ã€‚</p>
<p>æ—¢ç„¶å°æ•°å’Œè´Ÿæ•°éƒ½ä¸è¡Œï¼Œé‚£å¾ˆå¤§çš„æ•°å‘¢ï¼Ÿè¯•äº†ä¸€ä¸‹ 2147483647 ä¹Ÿä¸ä¼šå¯¼è‡´æº¢å‡ºã€‚æœ¬ä»¥ä¸ºæ˜¯ä¸è¡Œäº†ï¼Œç„¶åçªç„¶æƒ³èµ·æ¥æ—¶ä»£å˜äº†ï¼Œç°åœ¨éƒ½æ˜¯ 64 ä½äº†ã€‚è¯•äº†ä¸€ä¸‹ <code>9223372036854775807/6 = 1537228672809130000 + 6</code>ï¼Œæœç„¶æº¢å‡ºäº†ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>  <span style="color:#a6e22e">intval</span>(<span style="color:#ae81ff">6</span><span style="color:#f92672">+</span><span style="color:#ae81ff">1537228672809130000</span><span style="color:#f92672">*</span><span style="color:#ae81ff">6</span>)<span style="color:#f92672">+</span>(<span style="color:#ae81ff">1537228672809128622</span>)<span style="color:#f92672">*</span><span style="color:#ae81ff">6</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">20</span>
</span></span></code></pre></div><h2 id="é€æ˜çš„æ–‡ä»¶">é€æ˜çš„æ–‡ä»¶<a hidden class="anchor" aria-hidden="true" href="#é€æ˜çš„æ–‡ä»¶">#</a></h2>
<p>è¿™é“é¢˜ç›®ç»™äº†ä¸€ä¸ªåŒ…æ‹¬å¾ˆå¤š ANSI escape sequence çš„æ–‡ä»¶ï¼Œå½¢å¦‚ä¸‹</p>
<pre tabindex="0"><code>[0;0H[20;58H[8;34H[13;27H[4;2H[38;2;1;204;177m [39m[14;10H[20;51H[23;4H[12;2H[38;2;2;207;173m [39m[19;61H[9;12H[22;8H[20;2H[38;2;3;210;169m [39m[3;23H[8;68H[19;10H[4;3H[38;2;4;214;165m [39m[19;23H[17;34H[11;52H[22;70H[12;3H[38;2;5;217;161m [39m[24;22H[2;25H[19;76H[19;3H[38;2;6;220;157m [39m[23;14H[21;12H[10;37H[2;37H[22;66H[16;45H[21;3H[38;2;7;222;153m [39m[10;47H[18;34H[23;3H[38;2;8;225;149m
</code></pre><p>ç®€å•çœ‹äº†ä¸‹å‘ç°å¹¶æ²¡æœ‰ç©ºæ ¼ä»¥å¤–çš„å­—ç¬¦ï¼Œè€Œä¸”æ‰€æœ‰ \e ä¹Ÿéƒ½è¢«å¼„æ²¡äº†ï¼Œä¹Ÿå°±æ˜¯è¯´è‚¯å®šæ²¡æ³•é€šè¿‡ <code>echo -e $(cat transparent.txt)</code> è¿™ç§æ–¹æ³•ç›´æ¥æŸ¥çœ‹åˆ° flagã€‚</p>
<p>äºæ˜¯ä¸Šç½‘æ‰¾åˆ°äº†ä¸€ä¸ª python çš„ <a href="https://github.com/helgefmi/ansiterm">ANSI è§£æåº“</a>ï¼Œé­”æ”¹äº†ä¸€ä¸‹ä»£ç è®©å®ƒæ”¯æŒä¸å¸¦ <code>\e</code> çš„ escape sequenceï¼Œç„¶åè¾“å‡ºæ‰€æœ‰ä¿®æ”¹è¿‡çš„ä½ç½®ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>    term <span style="color:#f92672">=</span> Ansiterm(<span style="color:#ae81ff">25</span>, <span style="color:#ae81ff">80</span>)
</span></span><span style="display:flex;"><span>    term<span style="color:#f92672">.</span>feed(f<span style="color:#f92672">.</span>read())
</span></span><span style="display:flex;"><span>    tiles <span style="color:#f92672">=</span> Counter()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> y <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">25</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> tile <span style="color:#f92672">in</span> term<span style="color:#f92672">.</span>get_tiles(y <span style="color:#f92672">*</span> <span style="color:#ae81ff">80</span>, y <span style="color:#f92672">*</span> <span style="color:#ae81ff">80</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">80</span>):
</span></span><span style="display:flex;"><span>            tiles[repr(tile<span style="color:#f92672">.</span>color)] <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    default <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;{&#39;fg&#39;: 37, &#39;bg&#39;: 40, &#39;reverse&#39;: False, &#39;bold&#39;: False}&#34;</span>
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">.</span>join(
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;&#39;</span><span style="color:#f92672">.</span>join([<span style="color:#e6db74">&#39;x&#39;</span> <span style="color:#66d9ef">if</span> repr(tile<span style="color:#f92672">.</span>color) <span style="color:#f92672">!=</span> default <span style="color:#66d9ef">else</span> <span style="color:#e6db74">&#39; &#39;</span> <span style="color:#66d9ef">for</span> tile <span style="color:#f92672">in</span> term<span style="color:#f92672">.</span>get_tiles(y <span style="color:#f92672">*</span> <span style="color:#ae81ff">80</span>, y <span style="color:#f92672">*</span> <span style="color:#ae81ff">80</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">80</span>)]) <span style="color:#66d9ef">for</span> y
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">25</span>)))
</span></span></code></pre></div><p>è¾“å‡ºå¦‚ä¸‹</p>
<pre tabindex="0"><code>
    xx  xx                       xx          x
   x     x     xxx              x            x
 xxxxx   x        x    xxx      x     xxx    x     x   x
   x     x     xxxx   x   xx  xx         x   xxxx   x x   xxxx  xxxx
   x     x    x   x   x   x     x     xxxx   x   x   x    x   x x   x
   x     x    x   x    xxxx     x    x   x   x   x  x x   x   x x   x
   x      xx   xxx x      x      xx   xxx x  xxxx  x   x  x   x x   x
                       xxx
   x          x      x             xx
              x      x              x
 xxx    xxx   x      x  x   xxx     x     xxx xx    xxxx  xxx  x  x  x
   x   x   x  xxxx   x x       x    x     x  x  x  x     x   x x  x  x
   x   x   x  x   x  xx     xxxx    x     x  x  x  x     x   x x  x  x
   x   x   x  x   x  x x   x   x    x     x  x  x  x     x   x  x x x
    x   xxx   x   x  x  x   xxx x    xx   x  x  x   xxxx  xxx    x x

                         x     x   xxx   xx                 xx
  xxxx   xxx   x   x    x         x   x   x           x       x
 x          x  x   x  xxxxx  xxx  x   x   x    xxx  xxxxx     x
  xxxx   xxxx   xxxx    x      x   xxxx   x   x   x   x        xx
      x x   x      x    x      x      x   x   xxxxx   x       x
  xxxx   xxx x    x     x      x  x   x   x   x       x  x    x
                 x      x       x  xxx     xx  xxx     xx   xx
</code></pre><h2 id="flag-åŠ©åŠ›å¤§çº¢åŒ…">FLAG åŠ©åŠ›å¤§çº¢åŒ…<a hidden class="anchor" aria-hidden="true" href="#flag-åŠ©åŠ›å¤§çº¢åŒ…">#</a></h2>
<p><img loading="lazy" src="https://i.loli.net/2021/10/30/tcrkp2EdU3iGeNq.jpg" alt="ip.jpg"  />

è¿™é¢˜æ˜¯ä¸ª pdd å¥—è·¯ï¼Œéœ€è¦ 256 ä¸ªä¸åŒçš„ /8 ip åœ°å€ç ä¸€åˆ€æ‰èƒ½è·å¾— flagã€‚</p>
<blockquote>
<ol start="4">
<li>æ¯ä¸ªç”¨æˆ·åªèƒ½å¤ŸåŠ©åŠ›ä¸€æ¬¡ã€‚ä¸ºäº†å»ºè®¾ä¸–ç•Œä¸€æµå¤§ç åˆ€å¹³å°ï¼Œæ´»åŠ¨è¦æ±‚ä½äºåŒä¸€ /8 ç½‘æ®µçš„ç”¨æˆ·å°†ä¼šè¢«è§†ä¸ºåŒä¸€ä¸ªç”¨æˆ·ã€‚ï¼ˆæ¯”å¦‚ IP åœ°å€ä¸º 202.38.64.1 å’Œ 202.39.64.1 å°†è¢«è§†ä¸ºåŒä¸€ç”¨æˆ·ã€‚ï¼‰è¾¾åˆ°åŠ©åŠ›æ¬¡æ•°ä¸Šçº¿åï¼Œå°†æ— æ³•å†å¸®åŠ©å¥½å‹åŠ©åŠ›ã€‚æˆ‘ä»¬ä½¿ç”¨å‰åç«¯æ–¹å¼æ£€æŸ¥ç”¨æˆ·çš„ IP ã€‚</li>
</ol>
</blockquote>
<p>ç®€å•è¯•äº†ä¸‹ï¼Œå‘ç°æ˜¯ç»å…¸çš„ <code>X-FORWARDED-FOR</code>ï¼Œäºæ˜¯ç›´æ¥å†™è„šæœ¬æ„é€ è¯·æ±‚ã€‚å”¯ä¸€çš„å‘å°±æ˜¯æœ‰è¯·æ±‚é™é€Ÿï¼Œæ‰€ä»¥æˆ‘è¿˜åŠ äº†ä¸ªé‡è¯•å¾ªç¯ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>succeed_ip<span style="color:#f92672">=</span>[]
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> len(succeed_ip)<span style="color:#f92672">!=</span><span style="color:#ae81ff">256</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">256</span>):
</span></span><span style="display:flex;"><span>        ip <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{</span>i<span style="color:#e6db74">}</span><span style="color:#e6db74">.1.1.1&#39;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> ip <span style="color:#f92672">in</span> succeed_ip: <span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>        txt<span style="color:#f92672">=</span>requests<span style="color:#f92672">.</span>post(<span style="color:#e6db74">&#39;http://202.38.93.111:10888/invite/9900a95d-3a58-47c6-8a88-89a093ff9f16&#39;</span>,
</span></span><span style="display:flex;"><span>                            data<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#39;ip&#39;</span>:ip}, headers<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#39;X-FORWARDED-FOR&#39;</span>:ip})<span style="color:#f92672">.</span>text
</span></span><span style="display:flex;"><span>        suc <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;æˆåŠŸ&#39;</span> <span style="color:#f92672">in</span> txt
</span></span><span style="display:flex;"><span>        print(ip, suc)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> suc:
</span></span><span style="display:flex;"><span>            succeed_ip<span style="color:#f92672">.</span>append(ip)
</span></span></code></pre></div><h2 id="åŠ å¯†çš„-u-ç›˜">åŠ å¯†çš„ U ç›˜<a hidden class="anchor" aria-hidden="true" href="#åŠ å¯†çš„-u-ç›˜">#</a></h2>
<p>è¿™é“é¢˜ç»™äº†ä¸¤ä¸ª LUKS ï¼ˆLinux Unified Key Setupï¼‰åŠ å¯†çš„é•œåƒï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªé•œåƒçš„å¯†ç æ˜¯å·²çŸ¥çš„ã€‚è§£å¯†å‡ºæ¥å‘ç°æ˜¯ä¸€ä¸ª<code>éšæœºè¿‡ç¨‹.txt</code>ï¼Œé‡Œé¢æ˜¯ä¸€äº›æ•°å­¦ç¬”è®°ï¼Œå¹¶æ²¡æœ‰ä»€ä¹ˆåµç”¨ã€‚åŠ å¯†æ–¹å¼çœ‹äº†çœ¼æ˜¯ <code>aes-xts-plain64</code>ã€‚</p>
<p>â€¦â€¦ç„¶åæˆ‘å°±è·‘åäº†ï¼Œä»¥ä¸ºæ˜¯ä¸€ä¸ª known-plaintext attackã€‚å•ƒäº†åŠå¤©èµ„æ–™ç„¶åçœ‹äº†ä¸€çœ¼è¿™é“é¢˜ <code>general</code> çš„ tagï¼Œåˆçœ‹äº†ä¸‹é€šå…³äººæ•°ï¼Œæ„Ÿè§‰ä¸å¤§å¯¹ã€‚ç„¶åæˆ‘åœ¨ä¸€æ¬¡é”™è¯¯çš„è§£å¯†å°è¯•ä¸­ï¼Œæƒ³åˆ°äº†è¯¥ä¸ä¼š passphrase å’ŒåŠ å¯†ç”¨çš„ key æ˜¯ä¸åŒçš„å§ï¼ˆåºŸè¯ï¼‰ã€‚äºæ˜¯å°±äº†è§£åˆ°äº† master key è¿™ä¹ˆä¸ªä¸œè¥¿ã€‚</p>
<p><img loading="lazy" src="https://i.loli.net/2021/10/30/mBenN6JK4z72FrM.jpg" alt="meme1.jpg"  />
</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span> sudo cryptsetup luksDump --dump-master-key /dev/loop1p1 <span style="color:#75715e"># è·å¾— masterkey çš„</span>
</span></span><span style="display:flex;"><span> cat masterkey| xxd -r -p &gt; masterkey.bin
</span></span><span style="display:flex;"><span> sudo cryptsetup --master-key-file masterkey.bin luksOpen /dev/loop1p1 day2
</span></span><span style="display:flex;"><span> mount /dev/mapper/day2 ./day2
</span></span><span style="display:flex;"><span> mkdir day2
</span></span><span style="display:flex;"><span> sudo mount /dev/mapper/day2 ./day2
</span></span><span style="display:flex;"><span> cat day2/flag.txt
</span></span></code></pre></div><h2 id="å›¾ä¹‹ä¸Šçš„ä¿¡æ¯">å›¾ä¹‹ä¸Šçš„ä¿¡æ¯<a hidden class="anchor" aria-hidden="true" href="#å›¾ä¹‹ä¸Šçš„ä¿¡æ¯">#</a></h2>
<p>ä» graphql ä¸Šæ‹¿æ•°æ®çš„ç™½ç»™é¢˜ã€‚</p>
<p><img loading="lazy" src="https://i.loli.net/2021/10/30/kZHUCPoj7fSBFph.gif" alt="graphql.gif"  />
</p>
<h2 id="èµ›åšå¨æˆ¿">èµ›åšå¨æˆ¿<a hidden class="anchor" aria-hidden="true" href="#èµ›åšå¨æˆ¿">#</a></h2>
<p>è¿™é“é¢˜æœ¬è´¨ä¸Šæ˜¯ä¸ªæŒ–çŸ¿é¢˜ï¼ˆé›¾ï¼‰ã€‚å‰ä¸¤é¢˜éƒ½æ˜¯æ•™ç¨‹ï¼Œå°±ä¸è®²äº†ã€‚ç¬¬å››å°é¢˜æˆ‘æ²¡åšå‡ºæ¥ï¼Œä¹Ÿä¸è®²äº†ï¼ˆxï¼‰ï¼Œé‡ç‚¹è¯´ä¸‹ç¬¬ä¸‰é¢˜ã€‚</p>
<p>é€šè¿‡é˜…è¯»ä»£ç å¾—çŸ¥ï¼Œæ¯ä¸€å¤©çš„èœè°±æ˜¯ç”± <code>sha256( '\n'.join(sha256(prog) for prog in programs) )</code> ç®—å‡ºæ¥çš„å€¼ä½œä¸ºéšæœºæ•°ç§å­ï¼Œç„¶å ARC4 éšæœºç”Ÿæˆå‡ºæ¥çš„ã€‚ç”±äº hash å’Œéšæœºæ•°ç®—æ³•éƒ½æŒºæ­£ç»çš„ï¼Œå¤§æ¦‚æ˜¯æ²¡æ³•ç›´æ¥ç¢°æ’äº†ã€‚</p>
<p>çœ‹äº†ä¸‹è¿™é“é¢˜ç›®æœ‰ 32 ç§ä¸åŒçš„èœï¼ŒéšæœºæŒ‘é€‰ 6 ä¸ªï¼ˆæœ‰é¡ºåºï¼‰ï¼Œé‚£ä¹ˆæœ‰ P(32,6)=652458240 ç§å¯èƒ½æ€§ã€‚æ„Ÿè§‰åªè¦è¿æ°”å¥½ï¼Œè¿˜æ˜¯å¯ä»¥è·‘å‡ºæ¥çš„ã€‚äºæ˜¯æ‰‹åŠ¨å®ç°äº†ä¸€ä¸‹ ARC4 éšæœºç®—æ³•ï¼ˆæ²¡æ‰¾åˆ°ç°æˆçš„åº“ï¼‰ï¼Œç„¶åç”¨å·¨å¿«çš„ pypy è·‘ï¼ˆå…¶å® cpp åº”è¯¥æ›´å¿«ï¼Œåªæ˜¯æ‡’äº†ï¼‰ã€‚</p>
<p>ä»£ç å†™å¾—ä¸‘å°±ä¸è´´äº†ï¼Œæ€è·¯å°±æ˜¯å…ˆåˆ›å»º 32 ä¸ªç¨‹åºåˆ†åˆ«å¯¹åº”èœè°±ä¸º 0,0,0,0,0,0; 1,1,1,1,1,1 &hellip;å³å…­ä¸ªéƒ½ä¸€æ ·çš„åœºæ™¯ã€‚ç„¶åå¼€å§‹å†™ä¸€ä¸ª dummy ç¨‹åºï¼Œå†…å®¹ä¸é‡è¦ï¼Œèƒ½è¿‡æ£€æŸ¥å°±å¥½ã€‚</p>
<p>æˆ‘è·‘å‡ºæ¥çš„ç»“æœå¦‚ä¸‹ï¼š</p>
<pre tabindex="0"><code>å‘å³ 1 æ­¥\næ‹¿èµ· 6 ä¸ªç‰©å“\nå‘å·¦ 1 æ­¥\næ”¾ä¸‹ 1 ä¸ªç‰©å“\næ”¾ä¸‹ 1 ä¸ªç‰©å“\næ”¾ä¸‹ 1 ä¸ªç‰©å“\næ”¾ä¸‹ 1 ä¸ªç‰©å“\næ”¾ä¸‹ 1 ä¸ªç‰©å“\næ”¾ä¸‹ 1 ä¸ªç‰©å“
å‘å³ 2 æ­¥\næ‹¿èµ· 6 ä¸ªç‰©å“\nå‘å·¦ 2 æ­¥\næ”¾ä¸‹ 1 ä¸ªç‰©å“\næ”¾ä¸‹ 1 ä¸ªç‰©å“\næ”¾ä¸‹ 1 ä¸ªç‰©å“\næ”¾ä¸‹ 1 ä¸ªç‰©å“\næ”¾ä¸‹ 1 ä¸ªç‰©å“\næ”¾ä¸‹ 1 ä¸ªç‰©å“
...
å‘å³ 32 æ­¥\næ‹¿èµ· 6 ä¸ªç‰©å“\nå‘å·¦ 32 æ­¥\næ”¾ä¸‹ 1 ä¸ªç‰©å“\næ”¾ä¸‹ 1 ä¸ªç‰©å“\næ”¾ä¸‹ 1 ä¸ªç‰©å“\næ”¾ä¸‹ 1 ä¸ªç‰©å“\næ”¾ä¸‹ 1 ä¸ªç‰©å“\næ”¾ä¸‹ 1 ä¸ªç‰©å“
å‘å·¦ 1912766784062 æ­¥
</code></pre><p>è¿™æ ·å°±å¯ä»¥è·‘å‡ºæ¥ä¸€ä¸ªæˆ‘ä»¬å·²æœ‰çš„32ç¨‹åºå¯ä»¥è§£å†³çš„èœè°±ã€‚å…¶å®ç”¨ 128 ä¸ªç¨‹åºï¼ˆä¸Šé™ï¼‰æ›´å¿«ï¼Œä½†æ˜¯æˆ‘æ‡’äº†ï¼ˆ</p>
<h2 id="é©¬èµ›å…‹">é©¬èµ›å…‹<a hidden class="anchor" aria-hidden="true" href="#é©¬èµ›å…‹">#</a></h2>
<p><img loading="lazy" src="https://i.loli.net/2021/10/30/Dy3B6QTzvco59XF.jpg" alt="qr_raw.jpg"  />
</p>
<p>æˆ‘æœ€å–œæ¬¢çš„ä¸€é“é¢˜ç›®ä¹‹ä¸€ï¼Œè¦ä»æ‰“äº†é©¬èµ›å…‹çš„äºŒç»´ç ä¸­è¿˜åŸä¿¡æ¯ã€‚ä¹ä¸€çœ‹æ„Ÿè§‰ä¸å¤§å¯èƒ½ï¼Œä½†æ˜¯å…¶å®æ¯ä¸ªé©¬èµ›å…‹å—çš„ç°åº¦æ•°å€¼å…¶å®æä¾›äº†å¾ˆå¤šä¿¡æ¯ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥æšä¸¾å…¶è¦†ç›–çš„äºŒç»´ç å—æ¥æ‰¾åˆ°ä¼šäº§ç”Ÿä¸€è‡´çš„é©¬èµ›å…‹å—çš„æƒ…å†µã€‚å½“ç„¶å¦‚æœåŒæ—¶è¦†ç›–äº† 2*2 çš„å—é‚£å°±æ²¡åŠæ³•äº†ï¼Œä¸è¿‡äºŒç»´ç æœ¬èº«ä¹Ÿæ˜¯æœ‰çº é”™èƒ½åŠ›çš„ï¼Œæ‰€ä»¥ä¹Ÿä¸éœ€è¦å®Œå…¨è¿˜åŸã€‚</p>
<p>è„šæœ¬åœ¨è¿™é‡Œï¼š<a href="qr_mosaic_recovery.py">https://gist.github.com/harrynull/10e03907e835c48b7fbae72109381769</a>ã€‚å†™çš„æ¯”è¾ƒä¹±ï¼Œè€Œä¸”è¦ç¨å¾®æ”¹ä¸€ä¸‹æ‰å¯ä»¥è·‘ã€‚è·‘å‡ºæ¥çš„ç»“æœå¦‚ä¸‹ï¼š</p>
<p><img loading="lazy" src="https://i.loli.net/2021/10/30/n9GRpPozYMuewyh.png" alt="result.png"  />
</p>
<h2 id="minecraft">minecRaft<a hidden class="anchor" aria-hidden="true" href="#minecraft">#</a></h2>
<p>è¿™ä¸€é¢˜å…¶å®å°±æ˜¯åæ··æ·†æºç ï¼Œç„¶åä»å¸¸æ•°å‘ç°æ˜¯ç”¨çš„ XTEA åŠ å¯†ã€‚ç»™äº†å¯†æ–‡å’Œå¯†é’¥æ±‚æ˜æ–‡ã€‚å”¯ä¸€æ‹¿å‡ºæ¥æä¸€ä¸‹çš„åŸå› æ˜¯æˆ‘åˆä»¥ä¸ºè¿™æ˜¯é“å¯†ç å­¦é¢˜äº†ï¼Œå› ä¸ºæˆ‘ä¸€å¼€å§‹åæ··æ·†å‡ºæ¥ä»¥ä¸ºæ˜¯ç»™äº†æ˜æ–‡å’Œå¯†æ–‡æ±‚å¯†é’¥ï¼Œçœ‹äº†ä¸‹ web æ ‡ç­¾å’Œè¿‡å…³äººæ•°æˆ‘æ‰æ¸…é†’è¿‡æ¥ã€‚</p>
<p><img loading="lazy" src="https://i.loli.net/2021/10/30/Ofh1yNugPGWAVeM.jpg" alt="meme2.jpg"  />
</p>
<h2 id="just-be-fun">JUST BE FUN<a hidden class="anchor" aria-hidden="true" href="#just-be-fun">#</a></h2>
<p>å¾ˆæœ‰æ„æ€çš„é¢˜ç›®ï¼Œä½†æ˜¯ä¹Ÿå¾ˆç¹çã€‚é¢˜ç›®å®šä¹‰äº†ä¸€ç§èˆ¹æ–°çš„ã€ä¸‰ç»´çš„ã€åªæœ‰æ ˆçš„è¯­è¨€ï¼Œè¦å®ç° + * shift or xor pow è¿ç®—ã€‚ä½œè€…å”¯ä¸€çš„æ¸©æŸ”æ˜¯æ‰€æœ‰çš„æ•°å­—éƒ½æ˜¯ä¸€ä½æ•°ï¼Œæ‰€ä»¥ä¸ç”¨å†™ readint äº†ã€‚ç¨å¾®å†™äº†ä¸€ç‚¹ä¹‹åæ„Ÿè§‰å¤ªéº»çƒ¦äº†äºæ˜¯è‡ªå·±ç¼–äº†ä¸€ä¸ª<a href="https://gist.github.com/harrynull/c011c8949f4cba1551e3d840805347ed">è¯­è¨€</a>å’Œä¸€ä¸ª<a href="https://gist.github.com/harrynull/24a7ab92ae48b318c158539daac5e148">ç¼–è¯‘å™¨</a>ï¼Œå†™äº†400+è¡Œä»£ç ï¼ˆå…¶å®æ„Ÿè§‰æ›´éº»çƒ¦äº†å§å–‚ï¼‰ã€‚</p>
<p>è‡ªç¼–è¯­è¨€éƒ¨åˆ†ä»£ç ï¼š</p>
<pre tabindex="0"><code># === handle | ===
$|
!s
nop*
!s
&gt;
# pop the operator
pop
# res = 0
# i = 1
0
1

# [op1, op2, res, i]
@or_while_cond
#while a + b != 0:
&gt;
fetch 3
fetch 5
+
@or_while
|*
# a+b &gt;= 0: UP
wrap up
#    if a % 2 + b % 2 != 0:
fetch 3
2
%
fetch 5
2
%
+
@or_bit_not_zero
|*
wrap up
#        res += i
# [op1, op2, res, i]
dup
# [op1, op2, res, i, i]
1
3
\
# [op1, op2, i, i, res]
+
# [op1, op2, i, RES]
1
2
\
# end if }
&gt;
</code></pre><p>ç¼–è¯‘ç»“æœå¦‚ä¸‹ï¼š
<img loading="lazy" src="https://i.loli.net/2021/10/30/AQtoTH57BkEz6cY.jpg" alt="diagram.jpg"  />
</p>
<h2 id="pq">pğŸ˜­q<a hidden class="anchor" aria-hidden="true" href="#pq">#</a></h2>
<p>æœ€å–œæ¬¢çš„é¢˜ç›®ä¹‹ä¸€ï¼Œä»é¢‘è°±åŠ¨ç”»æ¥è¿˜åŸéŸ³é¢‘ã€‚ä¸€ä»¶æˆ‘ä»æ¥æ²¡æƒ³è¿‡å¯è¡Œï¼Œä½†æ˜¯ä¸€æƒ³å´è§‰å¾—å¾ˆåˆç†çš„äº‹æƒ…ã€‚</p>
<p><img loading="lazy" src="https://i.loli.net/2021/10/30/2SeDHPmog7QE6uv.gif" alt="flag.gif"  />
</p>
<p>è¿™é“é¢˜ç›®çš„æ­£è§£å½“ç„¶æ˜¯æ‰¾ä¸€ä½ hifi å‘çƒ§å‹ç›¯ç€ gif çœ‹ä¸€ä¸‹ç„¶åè„‘å†…è¿˜åŸéŸ³é¢‘ï¼ˆbushiï¼‰ã€‚ä½†æ˜¯æˆ‘é™„è¿‘æ²¡æœ‰å‘çƒ§å‹æ‰€ä»¥æˆ‘åªèƒ½å†™ä»£ç è¿˜åŸã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>gif <span style="color:#f92672">=</span> Image<span style="color:#f92672">.</span>open(<span style="color:#e6db74">&#34;./flag.gif&#34;</span>)
</span></span><span style="display:flex;"><span>frames <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> frame <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">8</span>, gif<span style="color:#f92672">.</span>n_frames):
</span></span><span style="display:flex;"><span>    gif<span style="color:#f92672">.</span>seek(frame)
</span></span><span style="display:flex;"><span>    frames<span style="color:#f92672">.</span>append(np<span style="color:#f92672">.</span>sum(np<span style="color:#f92672">.</span>array(gif), axis<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)[<span style="color:#ae81ff">3</span>::<span style="color:#ae81ff">4</span>] <span style="color:#f92672">+</span> min_db)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>frames <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>asarray(frames)<span style="color:#f92672">.</span>transpose()
</span></span><span style="display:flex;"><span>y_inv <span style="color:#f92672">=</span> librosa<span style="color:#f92672">.</span>feature<span style="color:#f92672">.</span>inverse<span style="color:#f92672">.</span>mel_to_audio(
</span></span><span style="display:flex;"><span>    librosa<span style="color:#f92672">.</span>db_to_power(frames),
</span></span><span style="display:flex;"><span>    n_fft<span style="color:#f92672">=</span>fft_window_size,
</span></span><span style="display:flex;"><span>    hop_length<span style="color:#f92672">=</span>frame_step_size,
</span></span><span style="display:flex;"><span>    window<span style="color:#f92672">=</span>window_function_type
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>sf<span style="color:#f92672">.</span>write(<span style="color:#e6db74">&#39;output.wav&#39;</span>, y_inv, <span style="color:#ae81ff">22050</span>, <span style="color:#e6db74">&#39;PCM_24&#39;</span>)  <span style="color:#75715e"># 634bil 971 mil 243 tho 582</span>
</span></span></code></pre></div>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/ctf/">CTF</a></li>
      <li><a href="http://localhost:1313/tags/%E8%A7%A3%E8%B0%9C/">è§£è°œ</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2024 <a href="http://localhost:1313/">Harry Yu | Blog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
